{% load static %}
<h1>Battle of Bands Registration</h1>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form action="{% url 'registrations:bob' %}" method="post" enctype="multipart/form-data">
{% csrf_token %}
    
    <fieldset>
        <legend>Identification</legend>
        {{ registration_form.band_name.label_tag }}
        {{ registration_form.band_name }}
        {% if registration_form.band_name.errors %}
            {% for error in registration_form.band_name.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}

        {{ registration_form.city.label_tag }}
        {{ registration_form.city }}
        {% if registration_form.city.errors %}
            {% for error in registration_form.city.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}

        {{ registration_form.genre.label_tag }}
        {{ registration_form.genre }}
        {% if registration_form.genre.errors %}
            {% for error in registration_form.genre.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}
    </fieldset>

    <fieldset>
        <legend>Contact Information</legend>
        {{ registration_form.facebook_link.label_tag }}
        {{ registration_form.facebook_link }}
        {% if registration_form.facebook_link.errors %}
            {% for error in registration_form.facebook_link.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}

        {{ registration_form.email.label_tag }}
        {{ registration_form.email }}
        {% if registration_form.email.errors %}
            {% for error in registration_form.email.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}
    </fieldset>

    <fieldset>
        <legend>Prelims Information</legend>
        {{ registration_form.prelims_venue.label_tag }}
        {{ registration_form.prelims_venue }}
        {% if registration_form.prelims_venue.errors %}
            {% for error in registration_form.prelims_venue.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}

        {{ registration_form.audio_sample.label_tag }}
        {{ registration_form.audio_sample }}
        {% if registration_form.audio_sample.errors %}
            {% for error in registration_form.audio_sample.errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}
    </fieldset>

    <fieldset>
        <legend>Participant Information</legend>
        {{ participant_formset.management_form }}

        {% for participant_form in participant_formset %}
            <div class="participant-formset">
                {{ participant_form.name.label_tag }}
                {{ participant_form.name }}
                {% if participant_form.name.errors %}
                    {% for error in participant_form.name.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}

                {{ participant_form.contact.label_tag }}
                {{ participant_form.contact }}
                {% if participant_form.contact.errors %}
                    {% for error in participant_form.contact.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}

                {{ participant_form.instrument.label_tag }}
                {{ participant_form.instrument }}
                {% if participant_form.instrument.errors %}
                    {% for error in participant_form.instrument.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            </div>
        {% endfor %}

        {% if participant_formset.non_form_errors %}
            {% for error in participant_formset.non_form_errors %}
                {{ error|escape }}
            {% endfor %}
        {% endif %}
    </fieldset>
    <input type="submit" value="Save" class="button"/>
</form>
<footer><p><a href="mailto:webmaster@pravega.org">Contact us</a> if you need any help!</p></footer>

<!-- Include formset plugin - including jQuery dependency -->
<script src="{% static 'jquery-3.2.1.min.js' %}"></script>
<script src="{% static 'jquery.formset.js' %}"></script>
<script>
    $('.participant-formset').formset({
        addText: 'Add participant',
        deleteText: 'Remove Participant'
    });
</script>
